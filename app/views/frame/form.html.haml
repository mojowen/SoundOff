#main{ "ng-app" => true }
	#popup{ "ng-controller" => "formScope" }
		%h2.hash_tag {{name}}
		#close X Close
		%form#form{ :class => 'stage_{{stage}}', 'ng-submit' => 'nextStage()' }
			= image_tag( @body_class.index('light') ? 'logo_dark.png' : 'logo_small.png' , :class => 'stage_1 stage_2')

			#stage_1
				%input{ :placeholder => "Zip Code", "ng-model" => "zip", :id => 'zip' }

				- unless ( @campaign.email_option == 'hidden' rescue false )
					%input{ :placeholder => "Email", "ng-model" => "email", :id => 'email'  }

				- if ( @campaign.email_option == 'optional' rescue true )
					.signups{ 'ng-hide' => 'email != "" '} Email is Optional

				- if ( @campaign.collect_email rescue false ) && params[:email].nil?
					.signups{ 'ng-hide' => 'email == "" '}
						Itâ€™s OK to add me to the mailing list of:
						%br
						%input{ :type => 'checkbox', :checked => true, 'ng-model' => 'add_headcount' }
						%span{ :onclick => '$(this).prev().click()' } HeadCount.org
						%br
						- if ( @campaign.partner.name rescue false)
							%input{ :type => 'checkbox', :checked => true, 'ng-model' => 'add_partner' }
							%span{ :onclick => '$(this).prev().click()' } #{ @campaign.partner.name }
							%br
						I agree to
						= link_to 'terms and conditions', tos_path, :target => '_blank'
						and
						= link_to 'privacy policy', privacy_path, :target => '_blank'

			#stage_2
				%input{ :placeholder => 'Street Address', "ng-model" => 'street', :id => 'street' }

				%input{ :placeholder => 'City', "ng-model" => 'city', :id => 'city' }

				%p We need more information to find your Congressional Representative - help us out by providing your street address and city.

			#stage_3

				.target{ "ng-repeat" => "target in targets" }
					%img.profile_img{ 'ng-src' => "https://api.twitter.com/1/users/profile_image?screen_name={{target.twitter_id}}&size=bigger" }
					%h1 @{{ target.twitter_id }}

				.tag{ 'ng-hide' => 'drop_campaign'}
					{{campaign}}
					%span{ 'ng-click' => "removeCampaign()" } x

				%textarea{ :placeholder => 'Enter your message to {{targets_list()}}',"ng-model" => "message", :id => 'message' }

				%p
					- unless @suggestions.empty?
						%a{ :href => '#', :onclick => 'suggest.style.display = "block"; return false;' } Suggestions?
					%span{ :style => 'float:right'}
						{{counter}}

			#stage_4
				%h1 Thanks!
				%h1 You're Almost Done
				%h3 Tell Your Friends and Set the #SoundOff
				.line
					%a.twitter{ 'ng-href' => '{{ twitter_link() }}', :target => '_blank' }
						.box
							= image_tag 'twitter_dark.png'
						Share on Twitter

				.line
					%a.facebook{ 'ng-href' => '{{ facebook_link() }}', :target => '_blank' }
						.box
							= image_tag 'facebook.png'
						Share on Facebook

				.line
					%a{ :href => 'http://headcount.org/register-to-vote', :target => '_blank' }
						.box
							= image_tag 'check.png'
						Register To Vote


			#notice
			%button.stage_1.stage_2 Continue

			%button.stage_3
				%span #S
				ound
				%span O
				ff

		#suggest
			%h3
				Need Help?
				%br
				Try one of these:

			- @suggestions.each do |suggestion|
				%p.link{ 'ng-click' => "setMessage( #{ suggestion.to_json } )" }
					=suggestion

			%a.no_thanks{ :href => '#', :onclick => 'suggest.style.display = "none"; return false;' } No Thanks